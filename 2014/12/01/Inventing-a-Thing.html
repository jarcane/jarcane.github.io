<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Inventing a Thing</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Inventing a Thing">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Inventing a Thing">
    <meta property="og:description" content="">

    <!-- <meta name="twitter:site" content="">

<meta name="twitter:creator" content="">

<meta name="google-site-verification" content="">

<meta property="fb:admins" content="">
 -->

    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link href="//fonts.googleapis.com/" rel="dns-prefetch">
    <link href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Open+Sans:700,400&subset=latin,latin-ext" rel="stylesheet">

    <link rel="stylesheet" href="//jarcane.github.io/themes/ghostium/assets/css/main.min.css?v=1500842109945"/>
    <link rel="stylesheet" href="//jarcane.github.io/themes/ghostium/assets/css/custom.css?v=1500842109945"/>
    <link rel="stylesheet" href="//jarcane.github.io/themes/ghostium/assets/css/asciidoctor-foundation.css?v=1500842109945"/>




    <script type="text/javascript">
      var ga_ua = 'UA-XXXXX-X';
      
      var disqus_shortname = 'example';
      
      var enable_pjax = true;

      // Pace Options
      // ==============
      window.paceOptions = {
        catchupTime: 100,
        minTime: 100,
        elements: false,
        restartOnRequestAfter: 500,
        startOnPageLoad: false
      }

      // Ghostium Globals
      // ==============
      window.GHOSTIUM = {};
      GHOSTIUM.haveGA = typeof ga_ua !== 'undefined' && ga_ua !== 'UA-XXXXX-X';
      GHOSTIUM.haveDisqus = typeof disqus_shortname !== 'undefined' && disqus_shortname !== 'example';
      GHOSTIUM.enablePjax = typeof enable_pjax !== 'undefined' ? enable_pjax : true;
    </script>

    <script src="//jarcane.github.io/themes/ghostium/assets/js/head-scripts.min.js?v=1500842109945"></script>

    <link rel="canonical" href="https://jarcane.github.io/2014/12/01/Inventing-a-Thing.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Arcane Syntax" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Inventing a Thing" />
    <meta property="og:description" content="One of the more ambitious features I decided to attempt for Heresy was to create a new kind of struct-like syntax that would be easier and faster to use in-place in a functional style. Racket has a very robust struct system which I was initially quite enamored of, but which" />
    <meta property="og:url" content="https://jarcane.github.io/2014/12/01/Inventing-a-Thing.html" />
    <meta property="article:published_time" content="2014-12-01T00:00:00.000Z" />
    <meta property="article:tag" content="Heresy" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Inventing a Thing" />
    <meta name="twitter:description" content="One of the more ambitious features I decided to attempt for Heresy was to create a new kind of struct-like syntax that would be easier and faster to use in-place in a functional style. Racket has a very robust struct system which I was initially quite enamored of, but which" />
    <meta name="twitter:url" content="https://jarcane.github.io/2014/12/01/Inventing-a-Thing.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Arcane Syntax",
    "author": {
        "@type": "Person",
        "name": "John Berry",
        "image": "https://avatars3.githubusercontent.com/u/8036258?v=4",
        "url": "https://jarcane.github.io/author/jarcane/",
        "sameAs": "http://jarcane.github.com"
    },
    "headline": "Inventing a Thing",
    "url": "https://jarcane.github.io/2014/12/01/Inventing-a-Thing.html",
    "datePublished": "2014-12-01T00:00:00.000Z",
    "keywords": "Heresy",
    "description": "One of the more ambitious features I decided to attempt for Heresy was to create a new kind of struct-like syntax that would be easier and faster to use in-place in a functional style. Racket has a very robust struct system which I was initially quite enamored of, but which"
}
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Arcane Syntax" href="https://jarcane.github.io/rss/" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/atom-one-dark.min.css">
  </head>
  <body class="post-template tag-Heresy">

    <button data-action="open-drawer" id="drawer-button" class="drawer-button"><i class="fa fa-bars"></i></button>
    <nav tabindex="-1" class="drawer">
      <div class="drawer-container">
        <!--.drawer-search(role="search")-->
        <ul role="navigation" class="drawer-list">
          
          <li class="drawer-list-item">
            <a href="https://jarcane.github.io" data-pjax>
              <i class="fa fa-home"></i>Home
            </a>
          </li>
          <!-- <li class="drawer-list-item">
            <a href="https://jarcane.github.io" title="Arcane Syntax" data-pjax>
              <i class="fa fa-list-alt"></i>All posts
            </a>
          </li> -->
          <li class="drawer-list-item">
            <a href="https://jarcane.github.io/rss/">
              <i class="fa fa-rss"></i>Subscribe to Feed
            </a>
          </li>
          <li class="drawer-list-divider"></li>
          <li class="drawer-list-item drawer-list-title">
            Follow me
          </li>
          
          
          <li class="drawer-list-item">
            <a href="https://twitter.com/J_Arcane" title="Twitter" target="_blank">
              <i class="fa fa-twitter"></i>Twitter
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="https://github.com/jarcane" title="Github" target="_blank">
              <i class="fa fa-github"></i>Github
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="drawer-overlay"></div>
    <main id="container" role="main" class="container">
      <div class="surface">
        <div class="surface-container">
          <div data-pjax-container class="content">
            
<section class="wrapper wrapper-post">
  <div class="wrapper-container">
    <article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post post tag-Heresy">
        <section class="post-container">
          <header class="post-header">
            <ul class="post-meta-list">
              <li class="post-meta-item">
                <time datetime="2014-12-01" itemprop="datePublished">
                  3 years ago
                </time>
              </li>
                <li class="post-meta-item">
                  <span class="tags"><i class="fa fa-tags"></i>
                      <span>
                      <a href="https://jarcane.github.io/tag/Heresy/">Heresy</a></span>
                  </span>
                </li>
              <li class="post-meta-item">
                <a href="#disqus_thread" data-disqus-identifier="">Comments</a>
              </li>
            </ul>
            <h1 itemprop="name headline" class="post-title"><a href="/" itemprop="url" data-pjax title="Inventing a Thing">Inventing a Thing</a></h1>
            <!--h2 itemprop="about" class="post-subtitle"></h2-->
          </header>
          <aside class="post-side">
            <div class="post-author">
                <a href="http://jarcane.github.com" class="post-author-avatar">
                  <img src="https://avatars3.githubusercontent.com/u/8036258?v&#x3D;4" alt="John Berry">
                </a>
              <div class="post-author-info">
                <a href="http://jarcane.github.com" class="post-author-name">
                  John Berry
                </a>
                <p class="post-author-bio"></p>
              </div>
            </div>
          </aside>
          <div itemprop="articleBody" class="post-body">
            <div class="paragraph">
<p>One of the more ambitious features I decided to attempt for Heresy was
to create a new kind of struct-like syntax that would be easier and
faster to use in-place in a functional style. Racket has a very robust
struct system which I was initially quite enamored of, but which I soon
discovered could get quickly cumbersome to deal with. For Heresy, I
wanted something simpler.</p>
</div>
<div class="paragraph">
<p>So, some days ago I wrote myself
<a href="https://github.com/jarcane/heresy/issues/5">a spec</a> for something called
"Things," but set it aside because I was largely convinced it would take
a considerable amount of wizardry to pull it off. The spec contained a
considerable amount of functionality, from pattern-matching syntax to
inheritance and on.</p>
</div>
<div class="paragraph">
<p>I was wrong. It took me half a day. And
<a href="https://github.com/jarcane/heresy/commit/7dd1456cbeae767be786cbeb94d40c5ea645f325">only
29 lines of code.</a></p>
</div>
<div class="paragraph">
<p>Part of the secret of course to this was actually in the reading and
studying I did trying to learn more about combinators and other such
lambda-based wizardry. It took me about a week of gestating, but what I
realized is that what I needed wasn&#8217;t a static data structure with some
macrology attached to various names, but actually, all that syntax
needed to live in the data structure itself. Then inheritance and
renaming and copying and all that fun stuff comes for free.</p>
</div>
<div class="paragraph">
<p>The result is Things. We can define a new kind of Thing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(describe Cthulhu (size 'Immense) (type 'Winged) (status 'sleeping))</pre>
</div>
</div>
<div class="paragraph">
<p>We can call values from Cthulhu:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; (Cthulhu 'size)
'Immense</pre>
</div>
</div>
<div class="paragraph">
<p>We can copy Cthulhu with new values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; ((Cthulhu * * 'awake) 'status)
'awake</pre>
</div>
</div>
<div class="paragraph">
<p>We can give a new name to Cthulhu:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; (def Dreamer Cthulhu)
&gt; (Dreamer 'type)
'Winged</pre>
</div>
</div>
<div class="paragraph">
<p>And we can make children of Cthulhu:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; (def Star-Spawn (Cthulhu 'Medium * 'awake))
&gt; (Star-Spawn 'size)
'Medium</pre>
</div>
</div>
<div class="paragraph">
<p>So how does it work? It&#8217;s all just a lambda. (describe &#8230;&#8203;) is a simple
macro wrapper that defines a name and seeds it with a call to (thing
&#8230;&#8203;), which is a helper function that returns a lambda containing a
closure that holds the actual alist that holds our values as well as the
argument handling code for calling and copying it. Indeed, copying
Things is just a recursive call to Thing with new values, and (thing
&#8230;&#8203;) can potentially be called anonymously just like lambdas can. And
because functions are first-class values, inheritence and value-passing
just come with the territory.</p>
</div>
<div class="paragraph">
<p>There is one weakness though:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; Cthulhu
#&lt;procedure:Cthulhu&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Because Things are just lambdas underneath, they read naked as
procedures, so they are not immediately transparent.</p>
</div>
<div class="paragraph">
<p>Instead, we have to do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; (Cthulhu)
'((size 'Immense) (type 'Winged) (status 'sleeping))</pre>
</div>
</div>
<div class="paragraph">
<p>Though on the upside, this is not merely a print routine: It actually
returns the naked alist underneath the snytax sugar, so you can mangle
it with assoc and subst or whatever other unspeakable horror you wish to
do to the Great Dreamer in the Deep.</p>
</div>
          </div>
          <footer class="post-footer">
            <div itemprop="author" itemscope itemtype="http://schema.org/Person" class="post-author">
                <a href="http://jarcane.github.com" class="post-author-avatar">
                  <img itemprop="image" src="https://avatars3.githubusercontent.com/u/8036258?v&#x3D;4" alt="John Berry">
                </a>
              <div class="post-author-info">
                <h4 class="post-footer-heading">Written By</h4>
                <a href="http://jarcane.github.com" itemprop="url" class="post-author-name">
                  <span itemprop="name">John Berry</span>
                </a>
                <p itemprop="description" class="post-author-bio"></p>
                  <p class="post-author-location">Finland</p>
                  <p class="post-author-website">
                    <a href="http://jarcane.github.com" rel="nofollow">http://jarcane.github.com</a>
                  </p>
                <p class="post-info">
                  <b class="post-info-title">Published on</b>
                  <time class="post-date">December 01, 2014</time>
                </p>
              </div>
            </div>
            <div class="post-social">
              <h4 class="post-footer-heading">Spread the word</h4>
              <a href="#" data-action="share-twitter"><i class="fa fa-fw fa-lg fa-twitter"></i></a>
              <a href="#" data-action="share-facebook"><i class="fa fa-fw fa-lg fa-facebook"></i></a>
              <a href="#" data-action="share-gplus"><i class="fa fa-fw fa-lg fa-google-plus"></i></a>
            </div>
          </footer>
        </section>
      <section itemprop="comment" class="post-comments">
        <div id="disqus_thread"></div>
      </section>
    </article>

    <footer role="contentinfo" class="footer">
      <p><small>Copyright &copy; <span itemprop="copyrightHolder">Arcane Syntax</span>. 2017. All Rights Reserved.</small></p>
      <p><small><a href="http://ghostium.oswaldoacauan.com/" target="_blank">Ghostium Theme</a> by <a href="http://twitter.com/oswaldoacauan" target="_blank">@oswaldoacauan</a></small></p>
      <p><small>Adapted by <a href="https://twitter.com/mgreau">Maxime Gréau</a></small></p>
      <p><small>Published with <a href="http://hubpress.io">HubPress</a></small></p>
    </footer>
  </div>
</section>


<section class="post-comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
  var disqus_shortname = 'jarcane'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


          </div>
        </div>
      </div>
    </main>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>
       
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

    <script src="//jarcane.github.io/themes/ghostium/assets/js/foot-scripts.min.js?v=1500842109945"></script>


  </body>
</html>
